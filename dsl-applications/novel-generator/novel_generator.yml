app:
  description: 'ä¸“ä¸šçš„é•¿ç¯‡å°è¯´ç”Ÿæˆåº”ç”¨ï¼Œæ”¯æŒä¸–ç•Œè§‚è®¾å®šã€å¤§çº²è§„åˆ’ã€è§’è‰²åˆ›å»ºã€ç« èŠ‚ç”Ÿæˆã€è‡ªåŠ¨å®¡æŸ¥ä¸æ¶¦è‰²ã€‚å¤šèŠ‚ç‚¹å·¥ä½œæµï¼Œæ¯ä¸ªé˜¶æ®µç‹¬ç«‹å¯è°ƒè¯•ã€‚'
  icon: ğŸ“š
  icon_background: '#FFF3E0'
  mode: advanced-chat
  name: é•¿ç¯‡å°è¯´ç”Ÿæˆå™¨V2
  use_icon_as_answer_icon: false
dependencies: []
kind: app
version: 0.4.0
workflow:
  conversation_variables:
  - description: å½“å‰ç”Ÿæˆé˜¶æ®µ
    id: ab77671b-7e2c-40ce-82cd-5ddedf0bd308
    name: stage
    value: init
    value_type: string
  - description: å°è¯´ä¸»é¢˜å’ŒèƒŒæ™¯æè¿°
    id: ef361743-6c7c-4ff3-b849-06186cb4075d
    name: theme
    value: ''
    value_type: string
  - description: ä¸–ç•Œè§‚è®¾å®šå†…å®¹
    id: 7e292323-49ad-43cd-a5fb-c20cdb4aab34
    name: worldview
    value: ''
    value_type: string
  - description: å°è¯´å®Œæ•´å¤§çº²
    id: 1e4c5659-fc9d-4fed-a06b-36a854d5f816
    name: outline
    value: ''
    value_type: string
  - description: è§’è‰²è®¾å®šå†…å®¹
    id: 70bf92d4-e395-42d7-8074-edca455b95cd
    name: characters
    value: ''
    value_type: string
  - description: å½“å‰ç« èŠ‚ç¼–å·
    id: a29ce65f-e4a8-4dcb-bb99-96c688df6264
    name: current_chapter
    value: 1
    value_type: number
  - description: å·²ç”Ÿæˆç« èŠ‚æ‘˜è¦
    id: 0cff2d54-bd9a-46be-b826-a7a94e279747
    name: chapters_summary
    value: ''
    value_type: string
  environment_variables: []
  features:
    file_upload:
      enabled: false
    opening_statement: "ğŸ‘‹ æ¬¢è¿ä½¿ç”¨é•¿ç¯‡å°è¯´ç”Ÿæˆå™¨V2ï¼\n\nå®Œæ•´çš„åˆ›ä½œæµç¨‹ï¼š\n1. ğŸ“– ä¸–ç•Œè§‚è®¾å®š\n2. ğŸ“‹ å¤§çº²è§„åˆ’\n3. ğŸ‘¥ è§’è‰²è®¾å®š\n4. âœï¸ ç« èŠ‚åˆ›ä½œï¼ˆå‰æƒ…æè¦ â†’ åˆç¨¿ â†’ å®¡æŸ¥æ¶¦è‰²ï¼‰\n\nè¯·å‘Šè¯‰æˆ‘æ‚¨æƒ³åˆ›ä½œçš„å°è¯´ç±»å‹å’Œä¸»é¢˜ï¼š"
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
    - æˆ‘æƒ³å†™ä¸€éƒ¨ä¿®ä»™å°è¯´ï¼Œä¸»è§’ä»å‡¡äººé€†è¢­æˆä»™
    - ç§‘å¹»å°è¯´ï¼Œå…³äºäººå·¥æ™ºèƒ½è§‰é†’çš„æ•…äº‹
    - æ‚¬ç–‘æ¨ç†å°è¯´ï¼Œå‘ç”Ÿåœ¨å°é—­åº„å›­çš„è°‹æ€æ¡ˆ
    suggested_questions_after_answer:
      enabled: true
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - id: start-to-if
      source: start_node
      sourceHandle: source
      target: if_stage
      targetHandle: target
      type: custom
    - id: if-to-worldview
      source: if_stage
      sourceHandle: case-init
      target: worldview_llm
      targetHandle: target
      type: custom
    - id: if-to-outline
      source: if_stage
      sourceHandle: case-outline
      target: outline_llm
      targetHandle: target
      type: custom
    - id: if-to-characters
      source: if_stage
      sourceHandle: case-characters
      target: characters_llm
      targetHandle: target
      type: custom
    - id: if-to-summary
      source: if_stage
      sourceHandle: case-ready
      target: summary_llm
      targetHandle: target
      type: custom
    - id: worldview-to-code1
      source: worldview_llm
      sourceHandle: source
      target: code_worldview
      targetHandle: target
      type: custom
    - id: code1-to-assigner-wv
      source: code_worldview
      sourceHandle: source
      target: assigner_worldview
      targetHandle: target
      type: custom
    - id: assigner-wv-to-stage1
      source: assigner_worldview
      sourceHandle: source
      target: assigner_stage1
      targetHandle: target
      type: custom
    - id: stage1-to-answer
      source: assigner_stage1
      sourceHandle: source
      target: answer_worldview
      targetHandle: target
      type: custom
    - id: outline-to-code2
      source: outline_llm
      sourceHandle: source
      target: code_outline
      targetHandle: target
      type: custom
    - id: code2-to-assigner-ol
      source: code_outline
      sourceHandle: source
      target: assigner_outline
      targetHandle: target
      type: custom
    - id: assigner-ol-to-stage2
      source: assigner_outline
      sourceHandle: source
      target: assigner_stage2
      targetHandle: target
      type: custom
    - id: stage2-to-answer
      source: assigner_stage2
      sourceHandle: source
      target: answer_outline
      targetHandle: target
      type: custom
    - id: characters-to-code3
      source: characters_llm
      sourceHandle: source
      target: code_characters
      targetHandle: target
      type: custom
    - id: code3-to-assigner-ch
      source: code_characters
      sourceHandle: source
      target: assigner_characters
      targetHandle: target
      type: custom
    - id: assigner-ch-to-stage3
      source: assigner_characters
      sourceHandle: source
      target: assigner_stage3
      targetHandle: target
      type: custom
    - id: stage3-to-answer
      source: assigner_stage3
      sourceHandle: source
      target: answer_characters
      targetHandle: target
      type: custom
    - id: summary-to-answer
      source: summary_llm
      sourceHandle: source
      target: answer_summary
      targetHandle: target
      type: custom
    - id: summary-to-draft
      source: summary_llm
      sourceHandle: source
      target: draft_llm
      targetHandle: target
      type: custom
    - id: draft-to-answer
      source: draft_llm
      sourceHandle: source
      target: answer_draft
      targetHandle: target
      type: custom
    - id: draft-to-polish
      source: draft_llm
      sourceHandle: source
      target: polish_llm
      targetHandle: target
      type: custom
    - id: polish-to-answer
      source: polish_llm
      sourceHandle: source
      target: answer_final
      targetHandle: target
      type: custom
    - id: answer-to-code-summary
      source: answer_final
      sourceHandle: source
      target: code_summary
      targetHandle: target
      type: custom
    - id: code-summary-to-assigner-summary
      source: code_summary
      sourceHandle: source
      target: assigner_summary
      targetHandle: target
      type: custom
    - id: assigner-summary-to-code-chapter
      source: assigner_summary
      sourceHandle: source
      target: code_chapter
      targetHandle: target
      type: custom
    - id: code-chapter-to-assigner-chapter
      source: code_chapter
      sourceHandle: source
      target: assigner_chapter
      targetHandle: target
      type: custom
    nodes:
    - data:
        desc: ç”¨æˆ·è¾“å…¥èµ·ç‚¹
        selected: false
        title: å¼€å§‹
        type: start
        variables: []
      height: 90
      id: start_node
      position:
        x: 80
        y: 400
      positionAbsolute:
        x: 80
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: case-init
          conditions:
          - comparison_operator: is
            id: cond-init
            value: init
            variable_selector:
            - conversation
            - stage
          logical_operator: and
        - case_id: case-outline
          conditions:
          - comparison_operator: is
            id: cond-outline
            value: outline
            variable_selector:
            - conversation
            - stage
          logical_operator: and
        - case_id: case-characters
          conditions:
          - comparison_operator: is
            id: cond-characters
            value: characters
            variable_selector:
            - conversation
            - stage
          logical_operator: and
        - case_id: case-ready
          conditions:
          - comparison_operator: is
            id: cond-ready
            value: ready
            variable_selector:
            - conversation
            - stage
          logical_operator: and
        desc: æ ¹æ®stageåˆ¤æ–­å½“å‰é˜¶æ®µ
        selected: false
        title: é˜¶æ®µåˆ¤æ–­
        type: if-else
      height: 126
      id: if_stage
      position:
        x: 380
        y: 370
      positionAbsolute:
        x: 380
        y: 370
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: ç”Ÿæˆä¸–ç•Œè§‚è®¾å®š
        model:
          completion_params:
            temperature: 0.8
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¸–ç•Œè§‚æ¶æ„å¸ˆã€‚\n\nç”¨æˆ·è¾“å…¥çš„ä¸»é¢˜ï¼š{{#sys.query#}}\n\nè¯·åˆ›å»ºè¯¦ç»†çš„ä¸–ç•Œè§‚è®¾å®šï¼ŒåŒ…æ‹¬ï¼š\n\n1. **æ—¶ä»£èƒŒæ™¯**ï¼šæ•…äº‹å‘ç”Ÿçš„æ—¶é—´ã€å†å²èƒŒæ™¯ã€æ—¶ä»£ç‰¹å¾\n2. **åœ°ç†ç¯å¢ƒ**ï¼šä¸»è¦åœ°ç‚¹ã€åŒºåŸŸç‰¹å¾ã€åœ°ç†åˆ†å¸ƒ\n3. **ç¤¾ä¼šç»“æ„**ï¼šæ”¿æ²»ä½“åˆ¶ã€ç¤¾ä¼šé˜¶å±‚ã€åŠ¿åŠ›åˆ†å¸ƒ\n4. **ç‰¹æ®Šè®¾å®š**ï¼ˆæ ¹æ®ç±»å‹ï¼‰ï¼š\n   - å¥‡å¹»ï¼šé­”æ³•ä½“ç³»ã€ç§æ—è®¾å®šã€ç¥è¯ä¼ è¯´\n   - ç§‘å¹»ï¼šç§‘æŠ€æ°´å¹³ã€æœªæ¥è®¾å®šã€æ˜Ÿé™…æ–‡æ˜\n   - æ­¦ä¾ ï¼šæ­¦å­¦ä½“ç³»ã€æ±Ÿæ¹–é—¨æ´¾ã€æ­¦æ—è§„çŸ©\n   - ç°ä»£ï¼šè¡Œä¸šèƒŒæ™¯ã€ç¤¾ä¼šç¯å¢ƒã€ç°å®è®¾å®š\n5. **æ ¸å¿ƒè§„åˆ™**ï¼šä¸–ç•Œè¿è¡Œçš„åŸºæœ¬æ³•åˆ™å’Œé™åˆ¶\n\nè¦æ±‚ï¼šé€»è¾‘è‡ªæ´½ã€å¯Œæœ‰åˆ›æ„ã€ä¸ºæƒ…èŠ‚å‘å±•ç•™ç©ºé—´"
        selected: false
        title: ä¸–ç•Œè§‚ç”Ÿæˆ
        type: llm
        vision:
          enabled: false
      height: 98
      id: worldview_llm
      position:
        x: 680
        y: 100
      positionAbsolute:
        x: 680
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: ç”Ÿæˆæ•…äº‹å¤§çº²
        model:
          completion_params:
            temperature: 0.8
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ•…äº‹å¤§çº²è§„åˆ’å¸ˆã€‚\n\n**ä¸–ç•Œè§‚**ï¼š\n{{#conversation.worldview#}}\n\n**ç”¨æˆ·æŒ‡ä»¤**ï¼š{{#sys.query#}}\n\nç°åœ¨è¯·åŸºäºä¸Šè¿°ä¸–ç•Œè§‚åˆ›å»ºå®Œæ•´çš„æ•…äº‹å¤§çº²ã€‚å¦‚æœç”¨æˆ·åªæ˜¯è¾“å…¥\"ç»§ç»­\"ã€\"ä¸‹ä¸€æ­¥\"ç­‰ç®€å•æŒ‡ä»¤ï¼Œè¯·ç›´æ¥æŒ‰ç…§æ ‡å‡†æµç¨‹ç”Ÿæˆï¼›å¦‚æœç”¨æˆ·æä¾›äº†å…·ä½“è¦æ±‚ï¼ˆå¦‚æ•…äº‹ç±»å‹ã€ä¸»è§’è®¾å®šç­‰ï¼‰ï¼Œè¯·ç»“åˆè¿™äº›è¦æ±‚ç”Ÿæˆã€‚\n\nè¯·åˆ›å»ºå¤§çº²ï¼ŒåŒ…æ‹¬ï¼š\n\n1. **æ•…äº‹ä¸»çº¿**ï¼šæ ¸å¿ƒå†²çªã€ä¸»è¦æƒ…èŠ‚èµ°å‘ã€ä¸»é¢˜æ€æƒ³\n2. **ç« èŠ‚è§„åˆ’**ï¼ˆ30-50ç« ï¼‰ï¼š\n   - æ¯ç« åŒ…æ‹¬ï¼šæ ‡é¢˜ã€ä¸»è¦æƒ…èŠ‚ã€è§’è‰²å‘å±•ã€å…³é”®å†²çª\n3. **æƒ…èŠ‚èŠ‚å¥**ï¼š\n   - èµ·ï¼šå¼€ç¯‡å¼•å…¥ï¼ˆ1-5ç« ï¼‰\n   - æ‰¿ï¼šæƒ…èŠ‚å±•å¼€ï¼ˆ6-20ç« ï¼‰\n   - è½¬ï¼šé«˜æ½®å†²çªï¼ˆ21-40ç« ï¼‰\n   - åˆï¼šç»“å±€æ”¶å°¾ï¼ˆ41-50ç« ï¼‰\n4. **ä¼ç¬”è®¾è®¡**ï¼šå…³é”®ä¼ç¬”çš„åŸ‹è®¾å’Œå›æ”¶ä½ç½®\n5. **é«˜æ½®è®¾ç½®**ï¼šä¸»è¦å†²çªç‚¹å’Œè½¬æŠ˜ç‚¹\n\nè¦æ±‚ï¼šæƒ…èŠ‚è·Œå®•èµ·ä¼ã€å¼ åŠ›é€’è¿›ã€æ¯ç« æœ‰çœ‹ç‚¹"
        selected: false
        title: å¤§çº²ç”Ÿæˆ
        type: llm
        vision:
          enabled: false
      height: 98
      id: outline_llm
      position:
        x: 680
        y: 240
      positionAbsolute:
        x: 680
        y: 240
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: ç”Ÿæˆè§’è‰²è®¾å®š
        model:
          completion_params:
            temperature: 0.8
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„è§’è‰²è®¾è®¡å¸ˆã€‚\n\n**ä¸–ç•Œè§‚**ï¼š\n{{#conversation.worldview#}}\n\n**æ•…äº‹å¤§çº²**ï¼š\n{{#conversation.outline#}}\n\n**ç”¨æˆ·æŒ‡ä»¤**ï¼š{{#sys.query#}}\n\nç°åœ¨è¯·åŸºäºä¸–ç•Œè§‚å’Œæ•…äº‹å¤§çº²åˆ›å»ºè§’è‰²è®¾å®šã€‚å¦‚æœç”¨æˆ·åªæ˜¯è¾“å…¥\"ç»§ç»­\"ã€\"ä¸‹ä¸€æ­¥\"ç­‰ç®€å•æŒ‡ä»¤ï¼Œè¯·ç›´æ¥æŒ‰ç…§æ ‡å‡†æµç¨‹ç”Ÿæˆï¼›å¦‚æœç”¨æˆ·æä¾›äº†å…·ä½“è¦æ±‚ï¼ˆå¦‚ä¸»è§’æ€§æ ¼ã€ç‰¹æ®Šèƒ½åŠ›ç­‰ï¼‰ï¼Œè¯·ç»“åˆè¿™äº›è¦æ±‚ç”Ÿæˆã€‚\n\nè¯·åˆ›å»ºè¯¦ç»†çš„è§’è‰²è®¾å®šï¼š\n\n**ä¸»è§’**ï¼š\n- å§“åã€å¹´é¾„ã€å¤–è²Œç‰¹å¾\n- æ€§æ ¼ç‰¹ç‚¹ï¼ˆä¼˜ç‚¹ã€ç¼ºç‚¹ã€ç‹¬ç‰¹æ°”è´¨ï¼‰\n- èƒŒæ™¯æ•…äº‹å’Œæˆé•¿ç»å†\n- æ ¸å¿ƒåŠ¨æœºå’Œç›®æ ‡\n- èƒ½åŠ›ç‰¹é•¿\n- è§’è‰²æˆé•¿è½¨è¿¹\n\n**é‡è¦é…è§’**ï¼ˆ3-5ä½ï¼‰ï¼š\n- åŸºæœ¬ä¿¡æ¯\n- æ€§æ ¼ç‰¹ç‚¹\n- ä¸ä¸»è§’å…³ç³»\n- åœ¨æ•…äº‹ä¸­çš„ä½œç”¨\n\n**åæ´¾è§’è‰²**ï¼š\n- åŸºæœ¬ä¿¡æ¯\n- åŠ¨æœºå’Œç›®æ ‡ï¼ˆåˆç†åŒ–ï¼Œé¿å…è„¸è°±åŒ–ï¼‰\n- ä¸ä¸»è§’çš„å†²çªç‚¹\n\n**äººç‰©å…³ç³»ç½‘**ï¼šè§’è‰²ä¹‹é—´çš„å…³ç³»ã€æƒ…æ„Ÿçº¿ç´¢ã€åˆ©ç›Šå†²çª\n\nè¦æ±‚ï¼šè§’è‰²é²œæ˜ã€æœ‰ç¼ºé™·å’Œæˆé•¿ç©ºé—´ã€åæ´¾åŠ¨æœºåˆç†"
        selected: false
        title: è§’è‰²ç”Ÿæˆ
        type: llm
        vision:
          enabled: false
      height: 98
      id: characters_llm
      position:
        x: 680
        y: 380
      positionAbsolute:
        x: 680
        y: 380
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: ç”Ÿæˆå‰æƒ…æè¦
        model:
          completion_params:
            temperature: 0.5
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ•…äº‹æ¢³ç†å¸ˆã€‚\n\n**æ•…äº‹å¤§çº²**ï¼š\n{{#conversation.outline#}}\n\n**è§’è‰²è®¾å®š**ï¼š\n{{#conversation.characters#}}\n\n**å½“å‰ç« èŠ‚**ï¼šç¬¬ {{#conversation.current_chapter#}} ç« \n\n**å·²ç”Ÿæˆç« èŠ‚æ‘˜è¦**ï¼š\n{{#conversation.chapters_summary#}}\n\n**ç”¨æˆ·æŒ‡ä»¤**ï¼š{{#sys.query#}}\n\nè¯·ç”Ÿæˆç®€æ´çš„å‰æƒ…æè¦ï¼ˆå¦‚æœæ˜¯ç¬¬1ç« å¯çœç•¥ï¼‰ï¼š\n\n1. **å…³é”®æƒ…èŠ‚å›é¡¾**ï¼šå·²å‘ç”Ÿçš„é‡è¦äº‹ä»¶ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰\n2. **è§’è‰²å‘å±•**ï¼šä¸»è¦è§’è‰²çš„çŠ¶æ€å’Œå˜åŒ–\n3. **å½“å‰å±€åŠ¿**ï¼šæ•…äº‹è¿›å±•åˆ°çš„é˜¶æ®µå’Œå†²çªçŠ¶æ€\n4. **å¾…è§£é—®é¢˜**ï¼šæ‚¬è€Œæœªå†³çš„ä¼ç¬”å’Œç–‘é—®\n5. **æœ¬ç« è¦ç‚¹**ï¼šæ ¹æ®å¤§çº²ï¼Œæœ¬ç« åº”è¯¥æ¨è¿›çš„æƒ…èŠ‚\n\nè¦æ±‚ï¼šç®€æ´æ˜äº†ï¼Œçªå‡ºé‡ç‚¹ï¼Œç¡®ä¿å‰åä¸€è‡´"
        selected: false
        title: å‰æƒ…æè¦
        type: llm
        vision:
          enabled: false
      height: 98
      id: summary_llm
      position:
        x: 680
        y: 520
      positionAbsolute:
        x: 680
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: ç”Ÿæˆç« èŠ‚åˆç¨¿
        model:
          completion_params:
            temperature: 0.9
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½æ‰åæ¨ªæº¢çš„å°è¯´ä½œå®¶ã€‚\n\n**åˆ›ä½œç´ æ**ï¼š\n- ä¸–ç•Œè§‚ï¼š{{#conversation.worldview#}}\n- æ•…äº‹å¤§çº²ï¼š{{#conversation.outline#}}\n- è§’è‰²è®¾å®šï¼š{{#conversation.characters#}}\n- å‰æƒ…æè¦ï¼š{{#summary_llm.text#}}\n- å½“å‰ç« èŠ‚ï¼šç¬¬ {{#conversation.current_chapter#}} ç« \n\n**åˆ›ä½œè¦æ±‚**ï¼š\n\nå­—æ•°ï¼š3000-5000å­—\n\nå†…å®¹è¦ç´ ï¼š\n- ä¸¥æ ¼éµå¾ªå¤§çº²è§„åˆ’çš„æœ¬ç« å†…å®¹\n- å±•ç°è§’è‰²æ€§æ ¼å’Œæˆé•¿\n- æ¨è¿›ä¸»çº¿æƒ…èŠ‚\n- è®¾ç½®æ‚¬å¿µæˆ–å†²çª\n- é€‚å½“åŸ‹è®¾æˆ–å›æ”¶ä¼ç¬”\n\nå†™ä½œæŠ€å·§ï¼š\n- è¯­è¨€ç”ŸåŠ¨ï¼Œå¯Œæœ‰ç”»é¢æ„Ÿ\n- å¯¹è¯è‡ªç„¶ï¼Œç¬¦åˆè§’è‰²æ€§æ ¼\n- åœºæ™¯æå†™ç»†è…»ï¼Œè°ƒåŠ¨å¤šç§æ„Ÿå®˜\n- å¿ƒç†æå†™æ·±å…¥\n- èŠ‚å¥æŠŠæ§å¾—å½“\n\næ³¨æ„äº‹é¡¹ï¼š\n- ä¸å‰æ–‡ä¿æŒä¸€è‡´\n- éµå¾ªä¸–ç•Œè§‚è®¾å®šè§„åˆ™\n- è§’è‰²è¡Œä¸ºç¬¦åˆæ€§æ ¼è®¾å®š\n- æƒ…èŠ‚å‘å±•åˆä¹é€»è¾‘\n\nè¯·å¼€å§‹åˆ›ä½œæœ¬ç« å†…å®¹ã€‚"
        selected: false
        title: ç« èŠ‚åˆç¨¿
        type: llm
        vision:
          enabled: false
      height: 98
      id: draft_llm
      position:
        x: 980
        y: 520
      positionAbsolute:
        x: 980
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: å®¡æŸ¥å¹¶æ¶¦è‰²ç« èŠ‚
        model:
          completion_params:
            temperature: 0.6
          mode: chat
          name: deepseek-chat
          provider: deepseek
        prompt_template:
        - role: system
          text: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„å°è¯´ç¼–è¾‘å’Œæ–‡å­¦æ¶¦è‰²å¸ˆã€‚\n\n**å‚è€ƒä¿¡æ¯**ï¼š\n- ä¸–ç•Œè§‚ï¼š{{#conversation.worldview#}}\n- å¤§çº²ï¼š{{#conversation.outline#}}\n- è§’è‰²ï¼š{{#conversation.characters#}}\n- å‰æƒ…ï¼š{{#summary_llm.text#}}\n- ç« èŠ‚åˆç¨¿ï¼š{{#draft_llm.text#}}\n\n**ä»»åŠ¡**ï¼šå¯¹åˆç¨¿è¿›è¡Œå®¡æŸ¥å’Œæ¶¦è‰²\n\n## å®¡æŸ¥æ£€æŸ¥\n\n**é€»è¾‘æ£€æŸ¥**ï¼š\n- æƒ…èŠ‚æ˜¯å¦åˆç†ï¼Ÿæ˜¯å¦ä¸å‰æ–‡çŸ›ç›¾ï¼Ÿ\n- æ˜¯å¦éµå¾ªä¸–ç•Œè§‚è§„åˆ™ï¼Ÿæ—¶é—´çº¿æ˜¯å¦æ¸…æ™°ï¼Ÿ\n\n**è§’è‰²æ£€æŸ¥**ï¼š\n- è¡Œä¸ºæ˜¯å¦ç¬¦åˆè®¾å®šï¼Ÿå¯¹è¯æ˜¯å¦ç¬¦åˆæ€§æ ¼ï¼Ÿ\n- æƒ…æ„Ÿå˜åŒ–æ˜¯å¦è‡ªç„¶ï¼Ÿ\n\n**æƒ…èŠ‚æ£€æŸ¥**ï¼š\n- æ˜¯å¦å®Œæˆæœ¬ç« å¤§çº²ç›®æ ‡ï¼Ÿ\n- å†²çªè®¾ç½®æ˜¯å¦åˆç†ï¼ŸèŠ‚å¥æ˜¯å¦å¾—å½“ï¼Ÿ\n\n## æ¶¦è‰²ä¼˜åŒ–\n\n**è¯­è¨€ä¼˜åŒ–**ï¼šæå‡æ–‡ç¬”ç¾æ„Ÿã€æ¶ˆé™¤é‡å¤å’Œç”Ÿç¡¬\n\n**æå†™å¢å¼º**ï¼š\n- ä¸°å¯Œç¯å¢ƒæå†™ï¼ˆè§†è§‰ã€å¬è§‰ã€è§¦è§‰ã€å—…è§‰ï¼‰\n- æ·±åŒ–å¿ƒç†æå†™\n- å¼ºåŒ–åŠ¨ä½œæå†™çš„ç”»é¢æ„Ÿ\n\n**æƒ…æ„Ÿæ¸²æŸ“**ï¼šå¢å¼ºæƒ…æ„Ÿå¼ åŠ›ã€ç»†åŒ–æƒ…ç»ªå˜åŒ–ã€è¥é€ æ°›å›´æ„Ÿ\n\n**èŠ‚å¥è°ƒæ•´**ï¼šç´§å¼ åœºæ™¯åŠ å¿«èŠ‚å¥ã€æŠ’æƒ…æ®µè½æ”¾æ…¢èŠ‚å¥\n\n**è¾“å‡ºè¦æ±‚**ï¼š\n- ç›´æ¥è¾“å‡ºä¿®æ”¹åçš„å®Œæ•´ç« èŠ‚å†…å®¹ï¼ˆ3000-5000å­—ï¼‰\n- ä¸è¦è¾“å‡ºä¿®æ”¹è¯´æ˜\n- ä¿æŒæ ¸å¿ƒæƒ…èŠ‚ä¸å˜\n- å¤§å¹…æå‡æ–‡å­¦æ€§å’Œå¯è¯»æ€§\n\nè¯·å¼€å§‹å®¡æŸ¥å’Œæ¶¦è‰²ã€‚"
        selected: false
        title: å®¡æŸ¥æ¶¦è‰²
        type: llm
        vision:
          enabled: false
      height: 98
      id: polish_llm
      position:
        x: 1280
        y: 520
      positionAbsolute:
        x: 1280
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: |
          def main(worldview_text: str) -> dict:
              return {
                  "worldview": worldview_text,
                  "next_stage": "outline"
              }
        code_language: python3
        desc: ä¿å­˜ä¸–ç•Œè§‚å¹¶æ›´æ–°stage
        outputs:
          worldview:
            type: string
          next_stage:
            type: string
        selected: false
        title: å¤„ç†ä¸–ç•Œè§‚
        type: code
        variables:
        - value_selector:
          - worldview_llm
          - text
          variable: worldview_text
      height: 54
      id: code_worldview
      position:
        x: 980
        y: 100
      positionAbsolute:
        x: 980
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ä¿å­˜ä¸–ç•Œè§‚å†…å®¹
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_worldview
          - worldview
          variable_selector:
          - conversation
          - worldview
          write_mode: over-write
        selected: false
        title: ä¿å­˜ä¸–ç•Œè§‚
        type: assigner
        version: '2'
      height: 86
      id: assigner_worldview
      position:
        x: 1280
        y: 100
      positionAbsolute:
        x: 1280
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: æ›´æ–°é˜¶æ®µä¸ºoutline
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_worldview
          - next_stage
          variable_selector:
          - conversation
          - stage
          write_mode: over-write
        selected: false
        title: æ›´æ–°é˜¶æ®µ1
        type: assigner
        version: '2'
      height: 86
      id: assigner_stage1
      position:
        x: 1580
        y: 100
      positionAbsolute:
        x: 1580
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: |
          def main(outline_text: str) -> dict:
              return {
                  "outline": outline_text,
                  "next_stage": "characters"
              }
        code_language: python3
        desc: å¤„ç†å¤§çº²
        outputs:
          outline:
            type: string
          next_stage:
            type: string
        selected: false
        title: å¤„ç†å¤§çº²
        type: code
        variables:
        - value_selector:
          - outline_llm
          - text
          variable: outline_text
      height: 54
      id: code_outline
      position:
        x: 980
        y: 240
      positionAbsolute:
        x: 980
        y: 240
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ä¿å­˜å¤§çº²å†…å®¹
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_outline
          - outline
          variable_selector:
          - conversation
          - outline
          write_mode: over-write
        selected: false
        title: ä¿å­˜å¤§çº²
        type: assigner
        version: '2'
      height: 86
      id: assigner_outline
      position:
        x: 1280
        y: 240
      positionAbsolute:
        x: 1280
        y: 240
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: æ›´æ–°é˜¶æ®µä¸ºcharacters
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_outline
          - next_stage
          variable_selector:
          - conversation
          - stage
          write_mode: over-write
        selected: false
        title: æ›´æ–°é˜¶æ®µ2
        type: assigner
        version: '2'
      height: 86
      id: assigner_stage2
      position:
        x: 1580
        y: 240
      positionAbsolute:
        x: 1580
        y: 240
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: |
          def main(characters_text: str) -> dict:
              return {
                  "characters": characters_text,
                  "next_stage": "ready"
              }
        code_language: python3
        desc: å¤„ç†è§’è‰²
        outputs:
          characters:
            type: string
          next_stage:
            type: string
        selected: false
        title: å¤„ç†è§’è‰²
        type: code
        variables:
        - value_selector:
          - characters_llm
          - text
          variable: characters_text
      height: 54
      id: code_characters
      position:
        x: 980
        y: 380
      positionAbsolute:
        x: 980
        y: 380
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ä¿å­˜è§’è‰²å†…å®¹
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_characters
          - characters
          variable_selector:
          - conversation
          - characters
          write_mode: over-write
        selected: false
        title: ä¿å­˜è§’è‰²
        type: assigner
        version: '2'
      height: 86
      id: assigner_characters
      position:
        x: 1280
        y: 380
      positionAbsolute:
        x: 1280
        y: 380
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: æ›´æ–°é˜¶æ®µä¸ºready
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_characters
          - next_stage
          variable_selector:
          - conversation
          - stage
          write_mode: over-write
        selected: false
        title: æ›´æ–°é˜¶æ®µ3
        type: assigner
        version: '2'
      height: 86
      id: assigner_stage3
      position:
        x: 1580
        y: 380
      positionAbsolute:
        x: 1580
        y: 380
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: |
          def main(draft: str, polish: str, current_chapter: int, old_summary: str) -> dict:
              # ç”Ÿæˆæœ¬ç« æ‘˜è¦ï¼ˆå–æ¶¦è‰²åçš„å‰200å­—ä½œä¸ºæ‘˜è¦ï¼‰
              chapter_text = polish[:200] + "..." if len(polish) > 200 else polish
              new_entry = f"\n\nã€ç¬¬{current_chapter}ç« æ‘˜è¦ã€‘\n{chapter_text}"
              
              # æ‹¼æ¥åˆ°å·²æœ‰æ‘˜è¦
              updated_summary = old_summary + new_entry if old_summary else new_entry
              
              return {
                  "updated_summary": updated_summary
              }
        code_language: python3
        desc: ç”Ÿæˆå¹¶æ‹¼æ¥ç« èŠ‚æ‘˜è¦
        outputs:
          updated_summary:
            type: string
        selected: false
        title: ç”Ÿæˆæ‘˜è¦
        type: code
        variables:
        - value_selector:
          - draft_llm
          - text
          variable: draft
        - value_selector:
          - polish_llm
          - text
          variable: polish
        - value_selector:
          - conversation
          - current_chapter
          variable: current_chapter
        - value_selector:
          - conversation
          - chapters_summary
          variable: old_summary
      height: 54
      id: code_summary
      position:
        x: 1880
        y: 520
      positionAbsolute:
        x: 1880
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ä¿å­˜ç« èŠ‚æ‘˜è¦
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_summary
          - updated_summary
          variable_selector:
          - conversation
          - chapters_summary
          write_mode: over-write
        selected: false
        title: ä¿å­˜æ‘˜è¦
        type: assigner
        version: '2'
      height: 86
      id: assigner_summary
      position:
        x: 2180
        y: 520
      positionAbsolute:
        x: 2180
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: |
          def main(current_chapter: int) -> dict:
              return {
                  "next_chapter": current_chapter + 1
              }
        code_language: python3
        desc: é€’å¢ç« èŠ‚å·
        outputs:
          next_chapter:
            type: number
        selected: false
        title: è®¡ç®—ä¸‹ä¸€ç« 
        type: code
        variables:
        - value_selector:
          - conversation
          - current_chapter
          variable: current_chapter
      height: 54
      id: code_chapter
      position:
        x: 2480
        y: 520
      positionAbsolute:
        x: 1580
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: æ›´æ–°ç« èŠ‚å·
        items:
        - input_type: variable
          operation: over-write
          value:
          - code_chapter
          - next_chapter
          variable_selector:
          - conversation
          - current_chapter
          write_mode: over-write
        selected: false
        title: æ›´æ–°ç« èŠ‚
        type: assigner
        version: '2'
      height: 86
      id: assigner_chapter
      position:
        x: 2780
        y: 520
      positionAbsolute:
        x: 2780
        y: 520
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "âœ… **ä¸–ç•Œè§‚è®¾å®šå®Œæˆï¼**\n\n{{#worldview_llm.text#}}\n\n---\n\nğŸ’¡ è¾“å…¥ã€Œç»§ç»­ã€æˆ–ã€Œç”Ÿæˆå¤§çº²ã€è¿›å…¥ä¸‹ä¸€æ­¥ã€‚"
        desc: ä¸–ç•Œè§‚é˜¶æ®µè¾“å‡º
        title: ä¸–ç•Œè§‚å›å¤
        type: answer
        variables: []
      height: 107
      id: answer_worldview
      position:
        x: 1880
        y: 120
      positionAbsolute:
        x: 1880
        y: 120
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "âœ… **å¤§çº²è§„åˆ’å®Œæˆï¼**\n\n{{#outline_llm.text#}}\n\n---\n\nğŸ’¡ è¾“å…¥ã€Œç»§ç»­ã€æˆ–ã€Œåˆ›å»ºè§’è‰²ã€è¿›å…¥è§’è‰²è®¾å®šã€‚"
        desc: å¤§çº²é˜¶æ®µè¾“å‡º
        title: å¤§çº²å›å¤
        type: answer
        variables: []
      height: 107
      id: answer_outline
      position:
        x: 1880
        y: 280
      positionAbsolute:
        x: 1880
        y: 280
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "âœ… **è§’è‰²è®¾å®šå®Œæˆï¼**\n\n{{#characters_llm.text#}}\n\n---\n\nğŸ’¡ è¾“å…¥ã€Œç”Ÿæˆç¬¬1ç« ã€æˆ–ã€Œå†™ç¬¬1ç« ã€å¼€å§‹ç« èŠ‚åˆ›ä½œã€‚"
        desc: è§’è‰²é˜¶æ®µè¾“å‡º
        title: è§’è‰²å›å¤
        type: answer
        variables: []
      height: 107
      id: answer_characters
      position:
        x: 1880
        y: 440
      positionAbsolute:
        x: 1880
        y: 440
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "ğŸ“ **å‰æƒ…æè¦ï¼ˆç¬¬{{#conversation.current_chapter#}}ç« ï¼‰**\n\n{{#summary_llm.text#}}\n\n---\n\nâ³ æ­£åœ¨ç”Ÿæˆåˆç¨¿..."
        desc: å‰æƒ…æè¦è¾“å‡º
        title: å‰æƒ…æè¦å›å¤
        type: answer
        variables: []
      height: 107
      id: answer_summary
      position:
        x: 1880
        y: 600
      positionAbsolute:
        x: 1880
        y: 600
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "âœï¸ **åˆç¨¿å®Œæˆï¼ˆç¬¬{{#conversation.current_chapter#}}ç« ï¼‰**\n\n{{#draft_llm.text#}}\n\n---\n\nâ³ æ­£åœ¨å®¡æŸ¥å’Œæ¶¦è‰²..."
        desc: åˆç¨¿è¾“å‡º
        title: åˆç¨¿å›å¤
        type: answer
        variables: []
      height: 107
      id: answer_draft
      position:
        x: 1880
        y: 760
      positionAbsolute:
        x: 1880
        y: 760
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: "âœ¨ **ç¬¬{{#conversation.current_chapter#}}ç« å®Œæˆï¼ˆå®¡æŸ¥æ¶¦è‰²åï¼‰**\n\n{{#polish_llm.text#}}\n\n---\n\nğŸ’¡ è¾“å…¥ã€Œç»§ç»­ã€æˆ–ã€Œç”Ÿæˆä¸‹ä¸€ç« ã€ç»§ç»­åˆ›ä½œã€‚"
        desc: æœ€ç»ˆè¾“å‡º
        title: æœ€ç»ˆå›å¤
        type: answer
        variables: []
      height: 107
      id: answer_final
      position:
        x: 1880
        y: 920
      positionAbsolute:
        x: 1880
        y: 920
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 0
      y: 0
      zoom: 0.5

